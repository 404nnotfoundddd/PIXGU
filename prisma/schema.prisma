// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id String @unique @default(cuid())

  ipAddress          String    @unique
  isAdmin            Boolean   @default(false)
  nickname           String    @unique
  preferences        Json      @default(dbgenerated("{}"))
  statistics         Json      @default(dbgenerated("{}"))
  achievements       Json      @default(dbgenerated("{}"))
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt
  isBanned           Boolean   @default(false)
  playingRoom        Room?     @relation(fields: [playingRoomId], references: [id])
  playingRoomId      String?   @unique
  writtenArticles    Article[] @relation("WrittenArticles")
  editedArticles     Article[] @relation("EditedArticles")
  translatedArticles Article[] @relation("TranslatedArticles")

  @@id([id])
  @@index([playingRoomId])
}

model Room {
  id String @id @default(cuid())

  name       String  @unique
  password   String?
  maxPlayers Int
  playingBy  User[]
}

model Article {
  id          String            @id @default(cuid())
  categories  ArticleCategory[]
  headerText  String
  content     String            @db.Text
  writers     User[]            @relation("WrittenArticles")
  editors     User[]            @relation("EditedArticles")
  translaters User[]            @relation("TranslatedArticles")
}

model ArticleCategory {
  id       String    @id @default(cuid())
  name     String
  articles Article[]
}